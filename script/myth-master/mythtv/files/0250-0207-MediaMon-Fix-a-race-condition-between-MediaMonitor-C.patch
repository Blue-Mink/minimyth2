From 1478d8f8a205176008e1bec3f188eb721a0a495b Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Mon, 3 Feb 2014 19:04:32 +0000
Subject: [PATCH 207/333] MediaMon: Fix a race condition between
 MediaMonitor::CheckDevices and DBus deviceRemoved
 signals

Signed-off-by: Lawrence Rust <lvr@softsystem.co.uk>
---
 mythtv/libs/libmyth/mythmediamonitor.cpp |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/mythtv/libs/libmyth/mythmediamonitor.cpp b/mythtv/libs/libmyth/mythmediamonitor.cpp
index 3e3d37b..c823a64 100644
--- a/mythtv/libs/libmyth/mythmediamonitor.cpp
+++ b/mythtv/libs/libmyth/mythmediamonitor.cpp
@@ -400,6 +400,8 @@ void MediaMonitor::CheckDevices(void)
     /* check if new devices have been plugged in */
     CheckDeviceNotifications();
 
+    QMutexLocker locker(&m_DevicesLock);
+
     QList<MythMediaDevice*>::iterator itr = m_Devices.begin();
     MythMediaDevice* pDev;
     while (itr != m_Devices.end())
-- 
1.7.9.5

