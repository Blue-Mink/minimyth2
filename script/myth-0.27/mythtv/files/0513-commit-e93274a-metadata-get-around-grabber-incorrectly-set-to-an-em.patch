From e93274a9d491a7dbe5614752dd414a0749298772 Mon Sep 17 00:00:00 2001
From: Jean-Yves Avenard <jyavenard@mythtv.org>
Date: Sat, 12 Jul 2014 03:47:19 +1000
Subject: [PATCH 14/15] metadata: get around grabber incorrectly set to an
 empty string

(cherry picked from commit 247d29ce10c1201da3bb35d088f91a8933e176b0)
---
 mythtv/libs/libmythmetadata/metadatagrabber.cpp |   10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/mythtv/libs/libmythmetadata/metadatagrabber.cpp b/mythtv/libs/libmythmetadata/metadatagrabber.cpp
index 389373a..f39d2ff 100644
--- a/mythtv/libs/libmythmetadata/metadatagrabber.cpp
+++ b/mythtv/libs/libmythmetadata/metadatagrabber.cpp
@@ -197,6 +197,13 @@ MetaGrabberScript MetaGrabberScript::GetType(const GrabberType type)
     QString cmd = gCoreContext->GetSetting(grabberTypes[type].setting,
                                            grabberTypes[type].def);
 
+    if (cmd.isEmpty())
+    {
+        // should the python bindings had not been installed at any stage
+        // the settings could have been set to an empty string, so use default
+        cmd = grabberTypes[type].def;
+    }
+
     if (grabberAge.secsTo(MythDate::current()) > kGrabberRefresh)
     {
         // polling the cache will cause a refresh, so lets just grab and
@@ -211,8 +218,7 @@ MetaGrabberScript MetaGrabberScript::GetType(const GrabberType type)
         // just pull it from the cache
         GrabberList list = GetList();
         GrabberList::const_iterator it = list.begin();
-        QString cmd = gCoreContext->GetSetting(grabberTypes[type].setting,
-                                               grabberTypes[type].def);
+
         for (; it != list.end(); ++it)
             if (it->GetPath().endsWith(cmd))
                 return *it;
-- 
1.7.10.2

