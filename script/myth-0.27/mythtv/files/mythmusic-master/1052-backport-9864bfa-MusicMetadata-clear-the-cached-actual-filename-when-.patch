From 9864bfa1587b7fe4b5fec603f5df900a35969d40 Mon Sep 17 00:00:00 2001
From: Paul Harrison <pharrison@mythtv.org>
Date: Sat, 8 Feb 2014 19:56:38 +0000
Subject: [PATCH 4/6] MusicMetadata: clear the cached actual filename when the
 filename is set

---
 mythtv/libs/libmythmetadata/musicmetadata.cpp |    6 ++++++
 mythtv/libs/libmythmetadata/musicmetadata.h   |    2 +-
 2 files changed, 7 insertions(+), 1 deletion(-)

diff --git a/mythtv/libs/libmythmetadata/musicmetadata.cpp b/mythtv/libs/libmythmetadata/musicmetadata.cpp
index 041cacf..e6e00b6 100644
--- a/mythtv/libs/libmythmetadata/musicmetadata.cpp
+++ b/mythtv/libs/libmythmetadata/musicmetadata.cpp
@@ -712,6 +712,12 @@ QString MusicMetadata::FormatTitle()
     return m_formattedtitle;
 }
 
+void MusicMetadata::setFilename(const QString& lfilename)
+{
+    m_filename = lfilename;
+    m_actualFilename.clear();
+}
+
 QString MusicMetadata::Filename(bool find)
 {
     // if not asked to find the file just return the raw filename from the DB
diff --git a/mythtv/libs/libmythmetadata/musicmetadata.h b/mythtv/libs/libmythmetadata/musicmetadata.h
index 72a37c1..e736133 100644
--- a/mythtv/libs/libmythmetadata/musicmetadata.h
+++ b/mythtv/libs/libmythmetadata/musicmetadata.h
@@ -197,7 +197,7 @@ class META_PUBLIC MusicMetadata
     bool isRadio(void) const { return ID_TO_REPO(m_id) == RT_Radio; }
 
     QString Filename(bool find = true);
-    void setFilename(const QString &lfilename) { m_filename = lfilename; }
+    void setFilename(const QString &lfilename);
     QString getLocalFilename(void);
 
     QString Hostname(void) { return m_hostname; }
-- 
1.7.10

