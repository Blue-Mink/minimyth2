From 3da6e767c16e7533ac5ab2e411faf9159457f305 Mon Sep 17 00:00:00 2001
From: Stuart Morgan <smorgan@mythtv.org>
Date: Mon, 24 Mar 2014 17:40:22 +0000
Subject: [PATCH 1/6] UPNP: Fix music streaming following the switch to
 storage groups

---
 mythtv/programs/mythbackend/services/content.cpp |    4 ++--
 mythtv/programs/mythbackend/upnpcdsmusic.cpp     |    1 +
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/mythtv/programs/mythbackend/services/content.cpp b/mythtv/programs/mythbackend/services/content.cpp
index 4cbbf8e..bd500ba 100644
--- a/mythtv/programs/mythbackend/services/content.cpp
+++ b/mythtv/programs/mythbackend/services/content.cpp
@@ -730,8 +730,8 @@ QFileInfo Content::GetMusic( int nId )
     // check to see if the file exists
     // ----------------------------------------------------------------------
 
-    if (QFile::exists( sFileName ))
-        return QFileInfo( sFileName );
+    if (!QFile::exists( sFileName ))
+        return GetFile( "Music", sFileName );
 
     return QFileInfo();
 }
diff --git a/mythtv/programs/mythbackend/upnpcdsmusic.cpp b/mythtv/programs/mythbackend/upnpcdsmusic.cpp
index c5f4902..3cbb977 100644
--- a/mythtv/programs/mythbackend/upnpcdsmusic.cpp
+++ b/mythtv/programs/mythbackend/upnpcdsmusic.cpp
@@ -12,6 +12,7 @@
 
 #include <QFileInfo>
 
+#include "storagegroup.h"
 #include "upnpcdsmusic.h"
 #include "httprequest.h"
 #include "mythcorecontext.h"
-- 
1.7.10.2

