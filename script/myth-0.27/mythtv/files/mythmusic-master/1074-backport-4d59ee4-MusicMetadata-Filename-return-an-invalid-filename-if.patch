From 4d59ee4145ed17395e24b43649be0843207f93ea Mon Sep 17 00:00:00 2001
From: Paul Harrison <pharrison@mythtv.org>
Date: Sun, 23 Feb 2014 13:03:57 +0000
Subject: [PATCH 3/8] MusicMetadata::Filename(): return an invalid filename if
 the file is not found

---
 mythtv/libs/libmythmetadata/musicmetadata.cpp |    5 ++++-
 mythtv/libs/libmythmetadata/musicmetadata.h   |    2 ++
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/mythtv/libs/libmythmetadata/musicmetadata.cpp b/mythtv/libs/libmythmetadata/musicmetadata.cpp
index 886e417..c025ef0 100644
--- a/mythtv/libs/libmythmetadata/musicmetadata.cpp
+++ b/mythtv/libs/libmythmetadata/musicmetadata.cpp
@@ -812,7 +812,10 @@ QString MusicMetadata::Filename(bool find)
     // not found
     LOG(VB_GENERAL, LOG_ERR, QString("MusicMetadata: Asked to get the filename for a track but no file found: %1")
                                      .arg(m_filename));
-    return QString();
+
+    m_actualFilename = METADATA_INVALID_FILENAME;
+
+    return m_actualFilename;
 }
 
 /// try to find the track on the local file system
diff --git a/mythtv/libs/libmythmetadata/musicmetadata.h b/mythtv/libs/libmythmetadata/musicmetadata.h
index 4fd747e..8173c3c 100644
--- a/mythtv/libs/libmythmetadata/musicmetadata.h
+++ b/mythtv/libs/libmythmetadata/musicmetadata.h
@@ -70,6 +70,8 @@ enum RepoType
 #define ID_TO_ID(x) x & METADATA_ID_MASK;
 #define ID_TO_REPO(x)  x >> METADATA_REPO_SHIFT
 
+#define METADATA_INVALID_FILENAME "**NOT FOUND**"
+
 class META_PUBLIC MusicMetadata
 {
     Q_DECLARE_TR_FUNCTIONS(MusicMetadata)
-- 
1.7.10

