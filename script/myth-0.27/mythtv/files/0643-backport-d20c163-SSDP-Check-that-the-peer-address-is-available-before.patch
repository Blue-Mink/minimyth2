From d20c163ee82c38f9d8fe4652b7a811af61925de7 Mon Sep 17 00:00:00 2001
From: Stuart Morgan <smorgan@mythtv.org>
Date: Wed, 19 Nov 2014 12:32:59 +0000
Subject: [PATCH 1/2] SSDP: Check that the peer address is available before
 doing the local network check.

Refs #12305
---
 mythtv/libs/libmythupnp/ssdp.cpp |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/mythtv/libs/libmythupnp/ssdp.cpp b/mythtv/libs/libmythupnp/ssdp.cpp
index 0b1f118..97cac89 100644
--- a/mythtv/libs/libmythupnp/ssdp.cpp
+++ b/mythtv/libs/libmythupnp/ssdp.cpp
@@ -325,7 +325,8 @@ void SSDP::ProcessData( MSocketDevice *pSocket )
     //
     // TODO: We may want to restrict this to the same subnet as the server
     //       for added security
-    if (((peerAddress.protocol() == QAbstractSocket::IPv4Protocol) &&
+    if (!peerAddress.isNull() && (peerAddress != QHostAddress::Null) &&
+        ((peerAddress.protocol() == QAbstractSocket::IPv4Protocol) &&
             (!peerAddress.isInSubnet(QHostAddress("172.16.0.0"), 12) &&
             !peerAddress.isInSubnet(QHostAddress("192.168.0.0"), 16) &&
             !peerAddress.isInSubnet(QHostAddress("10.0.0.0"), 8))) ||
-- 
1.7.10.2

