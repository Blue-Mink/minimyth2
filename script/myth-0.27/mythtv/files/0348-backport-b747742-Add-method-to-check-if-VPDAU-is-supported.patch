From b747742e8a75073fe0f08aca30261590b8e1d3fb Mon Sep 17 00:00:00 2001
From: Jean-Yves Avenard <jyavenard@mythtv.org>
Date: Thu, 22 May 2014 01:51:44 +1000
Subject: [PATCH 06/17] Add method to check if VPDAU is supported

---
 mythtv/libs/libmythui/mythrender_vdpau.cpp |   13 +++++++++++++
 mythtv/libs/libmythui/mythrender_vdpau.h   |    1 +
 2 files changed, 14 insertions(+)

diff --git a/mythtv/libs/libmythui/mythrender_vdpau.cpp b/mythtv/libs/libmythui/mythrender_vdpau.cpp
index b72fbec..cc389c9 100644
--- a/mythtv/libs/libmythui/mythrender_vdpau.cpp
+++ b/mythtv/libs/libmythui/mythrender_vdpau.cpp
@@ -297,6 +297,19 @@ MythRenderVDPAU::~MythRenderVDPAU(void)
     Destroy();
 }
 
+bool MythRenderVDPAU::IsVDPAUAvailable(void)
+{
+    if (gVDPAUSupportChecked)
+        return true;
+
+    LOG(VB_PLAYBACK, LOG_INFO, LOC + "Checking VDPAU support.");
+    MythRenderVDPAU *dummy = new MythRenderVDPAU();
+    bool supported = dummy->CreateDummy();
+    delete dummy;
+
+    return supported;
+}
+
 bool MythRenderVDPAU::IsMPEG4Available(void)
 {
     if (gVDPAUSupportChecked)
diff --git a/mythtv/libs/libmythui/mythrender_vdpau.h b/mythtv/libs/libmythui/mythrender_vdpau.h
index d933292..6e0ed41 100644
--- a/mythtv/libs/libmythui/mythrender_vdpau.h
+++ b/mythtv/libs/libmythui/mythrender_vdpau.h
@@ -62,6 +62,7 @@ class MUI_PUBLIC MythRenderVDPAU : public MythRender
     static uint gVDPAUBestScaling;
     static bool gVDPAUMPEG4Accel;
     static bool gVDPAUNVIDIA;
+    static bool IsVDPAUAvailable(void);
     static bool IsMPEG4Available(void);
     static bool H264DecoderSizeSupported(uint width, uint height);
     bool        CreateDummy(void);
-- 
1.7.10.2

