From 5447a509c2f19fd8c842d9a3b013a89cc88977be Mon Sep 17 00:00:00 2001
From: Paul Harrison <pharrison@mythtv.org>
Date: Sun, 5 Oct 2014 12:01:27 +0100
Subject: [PATCH] MythMusic: fix a possible crash after scanning for music

MusicMetadata::getSongAt() can return NULL so guard against that.
Fixes #12200. Thanks to JYA for finding the problem.
---
 mythplugins/mythmusic/mythmusic/musicplayer.cpp |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/mythplugins/mythmusic/mythmusic/musicplayer.cpp b/mythplugins/mythmusic/mythmusic/musicplayer.cpp
index e0f7efe..278628b 100644
--- a/mythplugins/mythmusic/mythmusic/musicplayer.cpp
+++ b/mythplugins/mythmusic/mythmusic/musicplayer.cpp
@@ -1089,7 +1089,8 @@ void MusicPlayer::restorePosition(void)
     {
         for (int x = 0; x < getCurrentPlaylist()->getTrackCount(); x++)
         {
-            if (getCurrentPlaylist()->getSongAt(x)->ID() == id)
+            if (getCurrentPlaylist()->getSongAt(x) &&
+                getCurrentPlaylist()->getSongAt(x)->ID() == id)
             {
                 m_currentTrack = x;
                 break;
-- 
1.7.10.2

