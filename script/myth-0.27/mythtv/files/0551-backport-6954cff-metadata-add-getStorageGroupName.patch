From 6954cff4005271b6360fdf25a4e2f7781a8e108a Mon Sep 17 00:00:00 2001
From: Jean-Yves Avenard <jyavenard@mythtv.org>
Date: Thu, 17 Jul 2014 18:19:08 +1000
Subject: [PATCH 05/16] metadata: add getStorageGroupName

remove duplicated code
---
 .../libs/libmythmetadata/metadataimagedownload.cpp |   43 +++++++++-----------
 .../libs/libmythmetadata/metadataimagedownload.h   |    1 +
 2 files changed, 20 insertions(+), 24 deletions(-)

diff --git a/mythtv/libs/libmythmetadata/metadataimagedownload.cpp b/mythtv/libs/libmythmetadata/metadataimagedownload.cpp
index 711187b..a1d4ab0 100644
--- a/mythtv/libs/libmythmetadata/metadataimagedownload.cpp
+++ b/mythtv/libs/libmythmetadata/metadataimagedownload.cpp
@@ -472,21 +472,10 @@ QString getLocalWritePath(MetadataType metadatatype, VideoArtworkType type)
 
 QString getStorageGroupURL(VideoArtworkType type, QString host)
 {
-    QString sgroup;
+    QString sgroup = getStorageGroupName(type);
     QString ip = gCoreContext->GetBackendServerIP(host);
     uint port = gCoreContext->GetBackendServerPort(host);
 
-    if (type == kArtworkCoverart)
-        sgroup = "Coverart";
-    else if (type == kArtworkFanart)
-        sgroup = "Fanart";
-    else if (type == kArtworkBanner)
-        sgroup = "Banners";
-    else if (type == kArtworkScreenshot)
-        sgroup = "Screenshots";
-    else
-        sgroup = "Default";
-
     return gCoreContext->GenMythURL(ip,port,"",sgroup);
 }
 
@@ -494,24 +483,30 @@ QString getLocalStorageGroupPath(VideoArtworkType type, QString host)
 {
     QString path;
 
-    StorageGroup sg;
-
-    if (type == kArtworkCoverart)
-        sg.Init("Coverart", host);
-    else if (type == kArtworkFanart)
-        sg.Init("Fanart", host);
-    else if (type == kArtworkBanner)
-        sg.Init("Banners", host);
-    else if (type == kArtworkScreenshot)
-        sg.Init("Screenshots", host);
-    else
-        sg.Init("Default", host);
+    StorageGroup sg(getStorageGroupName(type), host);
 
     path = sg.FindNextDirMostFree();
 
     return path;
 }
 
+QString getStorageGroupName(VideoArtworkType type)
+{
+    switch (type)
+    {
+        case kArtworkCoverart:
+            return "Coverart";
+        case kArtworkFanart:
+            return "Fanart";
+        case kArtworkBanner:
+            return "Banners";
+        case kArtworkScreenshot:
+            return "Screenshots";
+        default:
+            return "Default";
+    }
+}
+
 void cleanThumbnailCacheDir()
 {
     QString cache = QString("%1/cache/metadata-thumbcache")
diff --git a/mythtv/libs/libmythmetadata/metadataimagedownload.h b/mythtv/libs/libmythmetadata/metadataimagedownload.h
index aa9073f..6fe3ed5 100644
--- a/mythtv/libs/libmythmetadata/metadataimagedownload.h
+++ b/mythtv/libs/libmythmetadata/metadataimagedownload.h
@@ -115,6 +115,7 @@ META_PUBLIC QString getDownloadFilename(VideoArtworkType type, MetadataLookup *l
 META_PUBLIC QString getLocalWritePath(MetadataType metadatatype, VideoArtworkType type);
 META_PUBLIC QString getStorageGroupURL(VideoArtworkType type, QString host);
 META_PUBLIC QString getLocalStorageGroupPath(VideoArtworkType type, QString host);
+META_PUBLIC QString getStorageGroupName(VideoArtworkType type);
 
 META_PUBLIC void cleanThumbnailCacheDir(void);
 
-- 
1.7.10.2

