# For debug build:
# 1. Add  --compile-type=debug in ./configure parameters
# 2. Uncomment options=(!strip)in line 54
#
# For changing mythtv branch:
# -comment/uncomment appropriate at lines 13/14/15.
#  myth_update.sh script will follow automabically !

#----------------------------------------------------------------

root_pass="movax"
unatended="yes"
#unatended="no"
_gitname=mythtv-0.27
#_gitname=mythtv-master

gitsrcdir="/home/piotro/minimyth-dev/source/git-$_gitname"

patchs=(										\
    '0001-ticket2416_copy_eit_2_other_source.patch'					\
    '0002-ticket9480_pl_eit_encodings.patch'						\
    '0003-delay_4_no_concurent_start_rec.patch'						\
    '0004-eit_verbosity.patch'								\
    '0005-tid_debug_verbosity.patch'							\
    '0007-cardutil_show_displayname.patch'						\
    '0009-allow_no_tuners.patch'							\
    '0010-ticket10136_DBerrors_on_overlaping_EIT.patch'					\
    '0011-ticket9726-Unicable_SCR_DIN_EN_50494-v6.patch'				\
    '0012-dont_send_diseq_if_tuning_to_the_same_transponder.patch'			\
    '0013-reset_diseqc_bus_only_once_v4.patch'						\
    '0014-SCR_keep_disecq_always_18V.patch'						\
    '0015-resend_disecq_cmds.patch'							\
    '0016-mythweb_ticket10504_mythweb_php5.4.x_support.patch'				\
    '0017-mythweb_channels_serviceid_mplexid.patch'					\
    '0018-mythweb_killing_ffmpeg.patch'							\
    '0019-add_verbose_dvb_lock_info.patch'						\
    '0020-disable-findfrontends-in-mythweb.patch'					\
    '0021-make_EIT_start_at_time.patch'							\
    '0022-mythutil-add-an-option-to-check-recordings.patch'				\
    '0023-delay-concurent-tunings.patch'						\
    '0024-disable_break_when_no_PES_PUSI_set.patch'					\
    '0100-minimyth.patch'								\
    '0101-programid.patch'								\
    '0102-maintain_menu.patch'								\
    '0200-ticket9633_progressbar_on_osd.patch'						\
    '0202-_LMSC_osd.patch'								\
    '0203-udisks_timeout.patch'								\
    '0204-netvision_build.patch'							\
    '0205-mythmusic_quick_browsing.patch'						\
    '0206-python_bindings_tztime_error.patch'						\
    '0207-ticket10999_fix_white_screen_mythgallery.patch'				\
    '0208-add-mythnotification-custom-styles-support-via-UDP.patch'			\
    '0218-backport-c0c5299-Allow-Live-TV-to-be-entered-from-the-top-level-Progr.patch'	\
    '0219-backport-e3ee97c-Be-more-flexible-about-starting-the-Guide-at-a-parti.patch'	\
    '0220-backport-eb13dd5-Allow-the-Guide-start-channel-to-be-the-natural-Live.patch'	\
    '0221-backport-7fd5ad1-Update-cardinput.startchan-upon-successful-Live-TV-t.patch'	\
    '0222-backport-77ddcc1-Prefer-the-DefaultChanid-setting-when-picking-EPG-ch.patch'	\
    '0223-backport-98c9088-Add-tunability-tests-to-the-Watch-This-Channel-menu-.patch'	\
    '0224-add-osd-status-notify-to-mythmediacenter.patch'				\
    '0225-ticket11983.patch'								\
    '0229-add-disable-optical-disc-by-mm-config.patch'					\
    '0230-backport-93fdda5-MythMusic-re-factor-Playlist-to-avoid-storing-MusicM.patch'	\
    '0231-fix-zoneminder-1.26.5.patch'							\
    '0232-mythmusic_ticket10710_play_tracks_from_edit_trebors.patch'			\
    '0233-backport-70143d3-Allow-bookmarks-when-reading-DVDs-from-directories-i.patch'	\
    '0248-backport-2874f0d-Sync-libdvdread-up-to-R1290.patch'				\
    '0249-backport-2a6038b-Sync-libdvdnav-up-to-R1294.patch'				\
    '0251-backport-cd452cf-Minor-re-work-of-DVD-serialization-code-to-match-cod.patch'	\
    '0252-backport-b57cf4b-RemoteFile-add-a-static-FindFile-function-to-find-a-.patch'	\
    '0253-mythlink-pretty-with-recgroup-subdir.patch'					\
    '0254-backport-1f3fb4a-Removed-custom-dvdnav_first_play-function-from-libdv.patch'	\
    '0255-backport-137b8d7-Additional-files-missing-from-1f3fb4a61e.patch'		\
    '0258-backport-1e97539-Ensure-programflags-is-initialised.-ProgramInfo-Load.patch'	\
    '0259-ticket12055-hls-add-preset-tune.patch'					\
    '0260-ticket12047-mythplayer-picks-the-wrong-fps-for-1080i-matroska.patch'		\
    '0261-ticket12049-the-year-of-a-video-can-not-be-displayed-in-the-OSD-program-info.patch' \
    '0263-backport-588c95d-HLS-Don-t-allow-duplicate-streams-to-be-created.patch'	\
    '0264-backport-a9b8a86-HLS-Add-the-EXT-X-MEDIA-tags-to-the-Master-Playlist.patch'	\
    '0266-speedup-playback-start.patch'							\
    '0271-ticket11119.patch'								\
    '0274-backport-7c7d800-HLS-Don-t-scale-video-beyond-it-s-original-resolutio.patch'	\
    '0275-backport-847dce4-Transcoder-Remove-assumption-that-all-1080-video-is-.patch'	\
    '0276-backport-7133fc4-HLS-Enable-deinterlacing-for-HLS.-Web-videos-must-be.patch'	\
    '0277-backport-1012ad3-HLS-Fix-audio-only-bitrate-to-64k-per-Apple-recommen.patch'	\
    '0278-backport-2c71895-HLS-Decrease-segment-size-from-10-to-4-seconds-which.patch'	\
    '0279-backport-103d573-Fixes-null-dereference.patch'				\
    '0295-backport-b0aa4e5-Allow-capture-of-the-unprocessed-raw-MPTS-from-appro.patch'	\
    '0306-ticket10878-mythplayer-Don-t-call-DoneDisplayingFrame-for-PiP.patch'		\
    '0307-backport-95652b6-EIT-improvements-for-DVB.patch'				\
    '0308-backport-619b008-simplify-handling-of-missing-endtime-at-end-of-file-.patch'	\
    '0309-backport-7fd0a20-Fix-some-confusion-over-the-behaviour-purpose-of-IsS.patch'	\
    '0310-backport-0db22a0-Use-QEventLoop-for-modal-windows.patch'			\
    '0311-backport-cd80b1c-protect-metadata-loads-from-multiple-threads.patch'		\
    '0312-backport-3771b88-Fix-random-SBE-PlaybackSock-timeout-in-MBE.patch'		\
    '0313-backport-636ca29-Reduce-CPU-usage-while-waiting-for-seek-to-complete.patch'	\
    '0581-backport-ed52e84-Small-optimisation-of-FileRingBuffer-GetRealFileSize.patch'	\
    '0582-backport-c24e2e7-Fix-seek-when-close-to-end-of-program.patch'			\
    '0583-backport-cad3f0a-Do-not-abort-early-if-not-all-data-is-received-withi.patch'	\
    '0584-backport-5f47d69-Add-QUERY_FILETRANSFER-REQUEST_SIZE-command.patch'		\
    '0585-backport-6290fd9-Add-RemoteFile-GetRealFileSize.patch'			\
    '0586-backport-5d82ba6-Fix-seek-when-close-to-end-of-program-2.patch'		\
    '0587-backport-c64141b-Fix-calculation-of-read-block-size.patch'			\
    '0588-backport-2980b3d-Return-the-actual-file-size-rather-than-the-one-when.patch'	\
    '0589-backport-9883b43-Only-expire-LiveTV-programs-that-are-less-than-30s-a.patch'	\
    '0590-backport-dddf14c-Partial-revert-of-c64141b0c0b7118ee28be2441374727a1a.patch'	\
    '0591-backport-8c17413-Cache-the-size-of-the-remote-file-for-500ms.patch'		\
    '0592-backport-1da2a0e-Set-initial-FileRingBuffer-rawbitrate-to-800.patch'		\
    '0593-backport-1ff446a-RingBuffer-Play-encrypted-dvd-s-and-iso-images-from-.patch'	\
    '0608-backport-c519bba-Add-ReadInternalMode-to-RingBuffer-class.patch'		\
    '0609-backport-e469043-Try-to-open-the-media-for-1.5s-using-only-the-intern.patch'	\
    '0314-backport-ad1361a-Allows-RemoteFile-to-recover-from-connection-drop-or.patch'	\
    '0315-backport-305b409-Reset-failures-count-once-a-read-succeed.patch'		\
    '0316-backport-b87d476-Have-RemoteFile-attempt-to-fully-reconnect-in-case-o.patch'	\
    '0317-backport-4bb7059-Prevent-crash-should-playback-fail-after-ringbuffer-.patch'	\
    '0318-backport-904b65b-Don-t-prevent-read-should-we-reached-EOF-or-an-error.patch'	\
    '0319-backport-e8fa11c-Pause-playback-rather-than-exiting-should-backend-st.patch'	\
    '0320-backport-07eff1b-MythFrontend-Make-Xlib-calls-thread-safe-on-Linux.patch'	\
    '0321-backport-8877719-Fix-probable-cut-n-paste-error.-VB_PLAYBACK-should-b.patch'	\
    '0322-backport-fa75762-change-default-duplicate-detection-method-to-subtitl.patch'	\
    '0323-backport-dbb3874-Fix-stuttery-playback-for-FFmpeg-s-directly-rendered.patch'	\
    '0324-backport-2f1b223-ffmpeg-backport-register-vdpau-hwaccel-for-mpeg12.patch'	\
    '0325-backport-013ac54-Fixes-12128.patch'						\
    '0326-backport-a5b996c-Migrate-vdpau-decoding-to-FFmpeg-s-new-hwaccel-API.patch'	\
    '1000-backport-ce58f2b-MythMusic-move-the-music-file-scanner-into-libmythme.patch'	\
    '1001-backport-f6d85da-MythUtil-add-an-updatemeta-option-to-update-music-ta.patch'	\
    '1002-backport-0f987f3-MythMusic-only-send-track-added-removed-events-for-t.patch'	\
    '1003-backport-532b67d-MythMusic-start-decoupling-the-file-scanning-from-th.patch'	\
    '1004-backport-b614fac-MythUtil-add-a-scanmusic-option-to-start-a-scan-for-.patch'	\
    '1005-backport-63b6f37-MusicPlayer-show-some-notifications-showing-the-file.patch'	\
    '1006-backport-c71f06b-MythMusic-move-loadMusic-to-MusicData.patch'			\
    '1007-backport-c2835a6-MythMusic-check-all-tracks-in-a-playlist-are-still-v.patch'	\
    '1008-backport-7ccbcb2-MusicMetadata-remove-unused-function.patch'			\
    '1009-backport-5acb781-MythMusic-add-support-for-embedded-images-in-flac-xi.patch'	\
    '1010-backport-835791b-MythMusic-preserve-the-modified-timestamp-after-upda.patch'	\
    '1011-backport-d5cf173-MythMusic-make-sure-the-memory-cache-is-updated-afte.patch'	\
    '1012-backport-8ed610f-MythMusic-add-Music-and-MusicArt-to-the-special-stor.patch'	\
    '1013-backport-8aefe1b-Add-a-SCAN_MUSIC-command-to-the-myth-protocol.patch'		\
    '1014-backport-b1b6f14-MythMusic-update-the-file-scanner-to-scan-a-list-dir.patch'	\
    '1014-backport-dfd97aa0-Fix-inadvertent-double-scaling-of-images.-Some-break.patch'	\
    '1015-backport-52fa7ecc-In-MythImage-Load-don-t-treat-a-failed-image-load-as.patch' \
    '1016-backport-b0f5ccc-MusicMetadata-cache-the-actual-URL-of-the-file-when-.patch'	\
    '1017-backport-83a3e28-MythMusic-add-a-hostname-column-to-the-music_songs-t.patch'	\
    '1018-backport-df6b8a7-MusicMetadata-fix-updating-the-hostname-if-different.patch'	\
    '1019-backport-7b9d369-MusicMetadata-add-missing-comma-to-database-update-q.patch'	\
    '1020-backport-d6cb32f-RemoteFile-handle-the-slave-unreachable-case-in-Find.patch'	\
    '1021-backport-64bbf10-MythMusic-add-a-hostname-column-to-the-music_albumar.patch'	\
    '1022-backport-0de9f67-MythMusic-add-support-to-the-file-scanner-for-music-.patch'	\
    '1023-backport-6c70cd1-MainServer-update-the-SCAN_MUSIC-command-to-also-sca.patch'	\
    '1024-backport-dafa8d2-MythMusic-show-separate-file-scanner-status-notifica.patch'	\
    '1025-backport-2bbf5e1-MusicFileScanner-fix-updating-modified-tracks.patch'		\
    '1026-backport-97ae3f5-MythUtil-add-extractimage-command.patch'			\
    '1027-backport-e6c8a78-MainServer-add-a-MUSIC_TAG_GETIMAGE-command-to-the-m.patch'	\
    '1028-backport-92229a0-MythImage-fix-loading-images-from-slave-BE-s.patch'		\
    '1029-backport-5f88a66-AlbumArtImages-load-the-hostname-from-the-database.patch'	\
    '1030-backport-d632130-MythMusic-switch-the-filescanner-to-scan-the-Music-s.patch'	\
    '1031-backport-5369643-MythMusic-send-a-SCAN_MUSIC-command-to-the-master-BE.patch'	\
    '1032-backport-5163592-RemoteFile-add-a-CopyFile-static-function.patch'		\
    '1033-backport-bb32a29-RemoteFile-CopyFile-check-we-re-not-trying-to-copy-a.patch'	\
    '1034-backport-1c5b5e1-ImportMusic-update-the-music-import-to-use-storage-g.patch'	\
    '1035-backport-94fe080-MythMusic-remove-Directory-to-hold-music-setting-fro.patch'	\
    '1035-backport-b53ba13-MythMusic-check-we-have-at-least-one-directory-in-th.patch'	\
    '1036-backport-019d4c9-MusicMetadata-remove-some-no-longer-required-local-f.patch'	\
    '1037-backport-504fac8-MusicPlayer-no-need-to-update-the-music-directory-wh.patch'	\
    '1038-backport-a5ecdd0-MythMusic-remove-no-longer-required-get-setMusicDire.patch'	\
    '1039-backport-8faecfd-MythMusic-remove-the-local-file-access-from-findIcon.patch'	\
    '1040-backport-32527e2-MythMusic-update-retrieving-album-art-to-use-storage.patch'	\
    '1041-backport-a0b194d-AlbumArtImages-make-sure-the-hostname-is-saved-to-th.patch'	\
    '1042-backport-4920da1-MythMusic-check-we-have-found-some-tracks-before-sho.patch'	\
    '1043-backport-11c6a6e-MetaIO-Update-the-hostname-when-creating-an-AlbumArt.patch'	\
    '1044-backport-efc60a4-MusicAlbumArt-more-hostname-fixes-and-fix-the-file-n.patch'	\
    '1045-backport-61b91c9-Remove-some-debugging.patch'					\
    '1046-backport-94ee5e6-RemoteFile-Copy-fix-the-really-poor-performance.patch'	\
    '1047-backport-f36c44f-MythMusic-delete-any-unused-directory_ids-from-music.patch'	\
    '1048-backport-d8e6512-MythMusic-update-the-music-cd-ripper-to-use-storage-.patch'	\
    '1049-backport-1238ba4-MetaIO-Add-the-filename-to-write-and-writeVolatileMe.patch'	\
    '1050-backport-92d1750-MusicMetadata-add-the-missing-FileSize-implementatio.patch'	\
    '1051-backport-c83121a-MusicMetadata-add-a-getLocalFilename-function.patch'		\
    '1052-backport-9864bfa-MusicMetadata-clear-the-cached-actual-filename-when-.patch'	\
    '1053-backport-101b07e-Missed-a-file-in-1238ba43bcf.patch'				\
    '1054-backport-f20b9ca-CDRipper-fix-the-writing-of-the-metadata-to-the-tag.patch'	\
    '1055-backport-2f1a535-Myth-Protocol-add-a-MUSIC_TAG_UPDATE_VOLATILE-comman.patch'	\
    '1056-backport-3b212b5-MusicPlayer-use-the-myth-protocol-to-update-the-vola.patch'	\
    '1057-backport-d921746-Myth-Protocol-add-a-MUSIC_TAG_UPDATE_METADATA-comman.patch'	\
    '1058-backport-4d33752-MythMusic-don-t-send-SCAN_MUSIC-and-MUSIC_TAG_UPDATE.patch'	\
    '1059-backport-798db05-MythMusic-fix-saving-the-metadata-to-the-tag-on-the-.patch'	\
    '1060-backport-7fec2d4-MusicMetadata-make-sure-the-various-get-Id-functions.patch'	\
    '1061-backport-b351859-AlbumArtImages-add-option-to-not-load-images-from-th.patch'	\
    '1062-backport-d018509-Myth-Protocol-add-a-MUSIC_FIND_ALBUMART-command.patch'	\
    '1063-backport-74227e3-AlbumArtImages-add-a-scanForImages-function.patch'		\
    '1064-backport-1011c61-MusicImport-fix-switching-of-the-metadata-editor-to-.patch'	\
    '1065-backport-faea970-MusicImport-update-the-importing-of-albumart-to-work.patch'	\
    '1066-backport-5b18f41-MythMusic-start-updating-the-edit-metadata-screen-to.patch'	\
    '1067-backport-5cedac9-HandleMusicFindAlbumArt-only-save-the-filename-not-t.patch'	\
    '1068-backport-a9e332e-findIcon-add-option-to-ignore-the-cached-filename.patch'	\
    '1069-backport-af9c269-EditMetadata-update-the-internet-image-search-to-wor.patch'	\
    '1070-backport-98c3f59-MythUtil-add-a-calctracklen-option.patch'			\
    '1071-backport-b257f3c-Myth-Protocol-add-a-MUSIC_CALC_TRACK_LENGTH-command.patch'	\
    '1072-backport-0a755c7-MythMusic-fix-the-Check-Track-Length-option-on-the-e.patch'	\
    '1073-backport-fe65b3a-MythMusic-remove-the-redundant-calcTrackLength-from-.patch'	\
    '1074-backport-4d59ee4-MusicMetadata-Filename-return-an-invalid-filename-if.patch'	\
    '1075-backport-424bb16-MythMusic-improve-the-handling-of-unavailable-tracks.patch'	\
    '1076-backport-abd9204-MusicCommon-handle-TrackUnavailableEvents-from-the-m.patch'	\
    '1077-backport-ff91ef5-MythCenter-wide-Add-the-unavailable-state-to-the-pla.patch'	\
    '1078-backport-1847980-default-themes-Add-the-unavailable-state-to-the-play.patch'	\
    '1079-backport-576b2d7-MythCenter-wide-tweak-the-position-of-the-unavailabl.patch'	\
    '1080-backport-ad113b1-AlbumArtImages-update-the-id-after-dumping-to-the-da.patch'	\
    '1081-backport-4fe3cbc-AlbumArtImages-add-a-function-to-retrieve-an-image-b.patch'	\
    '1082-backport-f64b513-MythMusic-Allow-a-different-resume-mode-to-be-set-fo.patch'	\
    '1083-backport-2e009ed-MythMusic-fix-playback-from-CD-only-playing-the-firs.patch'	\
    '1084-backport-e350c8f-myth-protocol-add-a-MUSIC_TAG_ADDIMAGE-command.patch'	\
    '1085-backport-b9d40e4-myth-protocol-add-a-MUSIC_TAG_REMOVEIMAGE-command.patch'	\
    '1086-backport-d702b20-myth-protocol-fix-copy-paste-error-in-the-MUSIC_TAG_.patch'	\
    '1087-backport-c889cbd-mythutil-ExtractImage-Always-update-the-image-even-i.patch'	\
    '1088-backport-da2f845-MainServer-HandleMusicFindAlbumArt-cache-any-embedde.patch'	\
    '1089-backport-763d003-MainServer-HandleMusicTagGetImage-pass-the-ImageType.patch'	\
    '1090-backport-fd54a60-AlbumArtImages-scanForImages-fix-the-image-filename.patch'	\
    '1091-backport-96bf5c6-MythMusic-update-the-metadata-editor-adding-removing.patch'	\
    '1092-backport-cffec7f-MusicMetadata-copy-m_actualFilename-in-operator.patch'	\
    '1093-backport-5569a37-AlbumArtImages-use-the-filename-as-is-for-non-myth-u.patch'	\
    '1094-backport-efafb14-myth-protocol-add-a-MUSIC_TAG_CHANGEIMAGE-command.patch'	\
    '1095-backport-b4c0652-MythMusic-re-enable-the-change-image-type-option-in-.patch'	\
    '1096-backport-b9bbe36-myth-protocol-MUSIC_TAG_UPDATE_VOLATILE-pass-the-par.patch'	\
    '1097-backport-0706ec1-myth-protocol-MUSIC_-commands-pass-the-parameters-on.patch'	\
    '1098-backport-1153fae-Silence-a-couple-of-compiler-warnings.patch'			\
    '1099-backport-ad53f11-MusicMetadata-fix-missing-parameter-when-sending-MUS.patch'	\
    '1100-backport-abc3a32-Check-we-found-the-notification-image.-Fixes-Coverit.patch'	\
    '1101-backport-ab2ab7d-PlayerSettings-Fix-Uninitialized-pointer-fields.-Fix.patch'	\
    '1102-backport-0787da3-AlbumArtImage-Fix-leak-in-findImages.-Fixes-Coverity.patch'	\
    '1103-backport-35b4134-MainServer-Fix-leak-in-HandleMusicFindAlbumArt.-Fixe.patch'	\
    '1104-backport-d84e590-Fix-leak-in-ScanMusic-if-no-directories-found.-Fixes.patch'	\
#    '1105-backport-3ee65b3-Update-the-myth-protocol-version-after-the-addition-.patch'	\
    '1106-backport-dcd88dd-PlaylistEditorView-null-check-the-playlist-in-getPla.patch'	\
    '1107-backport-3a0b515-MetaIO-clear-the-m_fileinfo-struct-in-the-ctor-to-ke.patch'	\
    '1108-backport-c82bb00-MusicFileScanner-initialise-some-member-variables-in.patch'	\
    '1109-backport-98eda1b-MythSingleDownload-initialise-m_errorcode-in-the-cto.patch'	\
    '1110-backport-e715deb-findIcon-use-RemoteFile-FindFile-to-search-for-the-i.patch'	\
    '1111-backport-c5e7269-getAlbumArtFile-add-a-sanity-check-before-searching-.patch'	\
    '1112-backport-87c064d-PlaylistEditorView-make-sure-we-only-update-the-imag.patch'	\
    '1113-backport-264694f-PlaylistEditorView-don-t-bother-looking-for-an-icon-.patch'	\
    '1114-backport-41580eb-Myth-Protocol-add-optional-allowFallback-parameter-t.patch'	\
    '1115-backport-d7ad84a-RemoteFile-FindFile-make-sure-we-only-search-the-sto.patch'	\
    '1116-backport-2da65f4-PlaylistEditorView-don-t-use-itemVisible-if-using-th.patch'	\
    '1117-backport-ec6499f-AlbumArt-cycleImage-If-we-only-have-one-image-there-.patch'	\
    '1118-backport-3da6e76-UPNP-Fix-music-streaming-following-the-switch-to-sto.patch'	\
    '1119-backport-62d3892-UPNP-Fix-upnp-albumart-after-move-to-storage-groups.patch'	\
    '1120-backport-68ffe67-MythMusic-fix-filename-for-embedded-images-after-a-f.patch'	\
    '1121-backport-b947407-mythutil-make-sure-we-only-use-the-AlbumArt-storage-.patch'	\
    '1122-backport-e31b1e8-MythMusic-add-a-check-for-the-AlbumArt-storage-group.patch'	\
    '1123-backport-b965886-Playlist-silence-a-failed-query-warning-when-inserti.patch'	\
    '1124-backport-0716ca9-MythMusic-add-a-Reset-Database-button-on-the-general.patch'	\
    '1125-backport-23c5652-mythutil-send-a-MUSIC_ALBUMART_CHANGED-message-in-Ex.patch'	\
    '1126-backport-0b4724b-mythutil-Silence-a-compiler-warning-in-CalcTrackLeng.patch'	\
    '1127-backport-a31b85a-EditMetadata-handle-MUSIC_ALBUMART_CHANGED-messages-.patch'	\
    '1128-backport-399fc5c-RemoteFile-Prevent-FindFile-causing-the-master-backe.patch'	\
    '1129-backport-7f1f206-AlbumArtImages-add-some-additional-debug-messages-to.patch'	\
    '1130-backport-e18fb6d-MainServer-fix-the-filename-of-directory-images-in-H.patch'	\
    '1131-backport-db39719-MetaIOID3-fix-reading-of-metadata-from-id3-tags-in-..patch'	\
    '1132-backport-0e8e2e3-MythMusic-prefer-xiphComment-style-tags-in-flac-file.patch'	\
    '1133-backport-e02bbc5-MythMusic-fix-compilation-for-users-of-taglib-1.8.patch'	\
    '1134-backport-0cbe729-Attempt-to-fix-compilation-on-freeBSD.patch'			\
    '1135-backport-d7e6e24-MythMusic-allow-some-views-to-be-nested-so-you-can-r.patch'	\
    '1137-backport-9be71e1-CDRip-Fix-Coverity-ID-1196562-Division-or-modulo-by-.patch'	\
    '1138-backport-f89ac50-MythMusic-General-Settings-Fix-Coverity-ID-1196561-U.patch'	\
    '2038-Allow-rotating-an-image.-This-can-be-done-either-by-.patch'			\
    '2039-Updated-the-configure-script-to-include-the-exif-req.patch'			\
#    '2040-Added-the-new-database-tables-and-bumped-the-db-vers.patch'			\
    '2041-Added-a-new-jump-point.patch'							\
    '2042-Revert-Allow-rotating-an-image.-This-can-be-done-eit.patch'			\
    '2043-Added-an-orientation-feature-to-the-MythImage-and-My.patch'			\
    '2044-Added-jump-points-and-keybindings-and-the-call-to-th.patch'			\
    '2045-Made-the-new-image-service-API-known-to-the-backend.patch'			\
    '2046-Added-a-new-menu-entry-in-the-default-theme.patch'				\
    '2047-Added-the-gallery-file-for-the-default-theme.patch'				\
    '2048-Added-the-image-service-API-to-the-backend.patch'				\
    '2049-Added-the-required-service-contracts-for-the-image-s.patch'			\
    '2050-Added-the-files-to-synchronize-the-database.patch'				\
    '2051-Added-the-files-that-extracts-the-exif-information-f.patch'			\
    '2052-Added-the-files-that-holds-all-information-about-a-f.patch'			\
    '2053-Updated-the-pro-file.patch'							\
    '2054-Added-all-gallery-related-files-to-the-mythfrontend..patch'			\
    '2055-Remove-the-zoom-option-it-is-not-supported-by-the-My.patch'			\
    '2056-Added-clear-database-option.-This-will-remove-all-co.patch'			\
    '2057-Added-the-clear-database-button-to-the-default-theme.patch'			\
    '2058-Fixed-the-call-to-start-the-gallery-module-in-the-me.patch'			\
    '2059-Removed-the-unused-thumbnail-generation-progressbar.patch'			\
    '2060-Set-the-default-zoom-level-to-100.patch'					\
    '2061-Fixed-and-added-more-method-header-descriptions.patch'			\
    '2062-Fix-a-manual-merge-mistake.patch'						\
    '2063-Swap-MythSystem-for-MythSystemLegacy-in-GalleryThumb.patch'			\
    '2067-Fix-build-issue-for-older-installed-versions-of-Exiv.patch'			\
    '2072-Fix-a-number-of-db-query-issues-in-GalleryDatabaseHe.patch'			\
    '2078-Disable-the-old-mythgallery-plugin-by-default.-It-wi.patch'			\
    '2086-Fix-several-different-coverity-warnings-relating-to-.patch'			\
    '2096-Add-the-New-Image-Gallery-menu-item-to-the-classic-m.patch'			\
    '2097-Add-the-New-Image-Gallery-menu-item-to-the-DVR-menu-.patch'			\
    '2098-Add-the-New-Image-Gallery-menu-item-to-the-media-cen.patch'			\
    '2105-Added-new-service-API-call-to-only-get-the-directori.patch'			\
    '2106-Added-new-service-API-calls-to-rename-or-delete-a-ce.patch'			\
    '2107-Updated-the-DeleteFile-and-RenameFile-service-API-me.patch'			\
    '2123-Use-a-special-storage-group-Photographs-for-the-new-.patch'			\
    '2126-Store-a-relative-url-to-the-image-in-the-database-in.patch'			\
    '2132-Move-the-Gallery-thumb-generator-thread-class-to-lib.patch'			\
    '2160-Fix-mask-image-scaling-after-dfd97aa0.patch'					\
    '2270-Move-image-thumbnail-generation-to-the-backend.patch'				\
    '2283-Remove-some-stray-references-to-the-ImageThumbGenThr.patch'			\
    '2284-disable-schema-check-in-perl-bindings.patch'					\
	)

#----------------------------------------------------------------

pkgver=6.5.24
pkgrel=ge2acf0d
pkgbase=$_gitname
pkgname=('mythtv-base' 'mythtv-plugins')
pkgdesc="A personal video recorder for Linux"
url="http://www.mythtv.org"
license="GPL"
depends=('bash' 'mysql-clients>=5.0' 'qt' 'lame' 'lirc-utils' 'ffmpeg' 'freeglut' \
        'faad2' 'libxv' 'libxvmc' 'libavc1394' 'libdc1394' 'libiec61883' 'flac' \
        'taglib' 'libcdaudio' 'cdparanoia' \
        'perl-net-upnp')
makedepends=('libgl' 'subversion')
conflicts=('mythtv')
replaces=()
groups=('pvr')
backup=()
# options=(!strip)
install=mythtv-base.install
source=(`echo ${patchs[@]:0}`)
arch=('i686' 'x86_64')

MAKEFLAGS="-j`cat /proc/cpuinfo | grep -c '^processor[[:cntrl:]]*:'`"
msg "Building with $MAKEFLAGS CPUs"

build() {

  cd $gitsrcdir
  gitrel=$(git describe | sed -e "s/.*\-.*\-\(.*\)/\1/") #"

  msg "Making working copy..."
  rm -rf $srcdir/$_gitname-build 
  cp -r  $gitsrcdir $srcdir/$_gitname-build

  msg "Cleaning working copy of MythWEB..."
  cd $srcdir/$_gitname-build/mythplugins/mythweb
  find . -name '.git' | xargs /bin/rm -rf || return 0

  cd $srcdir/$_gitname-build

  msg "Updating version.h to current sources version..."
  sed -i -e "s/\"\${SOURCE_VERSION}\"/\"\${SOURCE_VERSION}-v$pkgver\"/" ./mythtv/version.sh

  msg "Applying patchs..."
  for i in `echo ${patchs[@]:0} `
  do
    echo "==>Applying $i"
    patch -Np1  -i ${startdir}/$i  || return 1
    echo " "
  done
  msg "All patchs applied sucessfuly !"
  echo " "
  if [ $unatended != "yes" ]; then
   echo "Press any key to continue..."
   read
  fi

}

package_mythtv-base() {

  cd $srcdir/$_gitname-build/mythtv

  ARCH="${CARCH/_/-}"

  ./configure \
      --prefix=/usr \
      --cpu="${ARCH}" \
      --enable-mmx \
      --enable-audio-oss \
      --enable-audio-alsa \
      --disable-audio-jack \
      --disable-audio-pulse \
      --disable-altivec \
      --disable-distcc \
      --disable-ccache \
      --enable-vdpau \
      --enable-dvb \
      --dvb-path=/usr/include \
      --enable-lirc \
      --enable-joystick-menu \
      --enable-xrandr \
      --enable-xv \
      --enable-x11 \
      --enable-libx264 \
      --enable-libfaac \
      --enable-nonfree \
      --with-bindings=perl,python \
      --python=python2 \
      --disable-mythlogserver \
      --compile-type=release

#      --compile-type=debug
#      --compile-type=release

  make all || return 1

  make INSTALL_ROOT="${pkgdir}" install || return 1

  install -d ${pkgdir}/usr/share/mythtv
  cp -af contrib ${pkgdir}/usr/share/mythtv/

  install -d -m0664 ${pkgdir}/var/http/mythweb
  cp -af $srcdir/$_gitname-build/mythplugins/mythweb/. ${pkgdir}/var/http/mythweb/
  chown -R http:http ${pkgdir}/var/http/mythweb
  chmod 0664 ${pkgdir}/var/http/mythweb

  cd $startdir
  install -D -m0644 mc.sql ${pkgdir}/usr/share/mythtv
  install -D -m0644 document-changelog.txt ${pkgdir}/usr/share/mythtv/changelog.txt
  install -D -m0644 PKGBUILD ${pkgdir}/usr/share/mythtv/mythtv-be-pkgbuild
  install -D -m0644 mythbackend.service ${pkgdir}/etc/systemd/system/mythbackend.service.new
  install -D -m0644 logrotate ${pkgdir}/etc/logrotate.d/mythbackend
  install -D -m0755 mythbackend.sh ${pkgdir}/usr/bin/mythbackend.sh
  install -D -m0755 mythfrontend.sh ${pkgdir}/usr/bin/mythfrontend.sh
  }

package_mythtv-plugins() {
#exit 0
  echo " "
  msg "Now will install mythtv-base as it is required for building mythtv-plugins..."
  echo " "
  if [ $unatended != "yes" ]; then
    echo "Press any key to continue..."
    read
  fi

  cd $startdir

  (echo "$root_pass") | sudo -S pacman -Uf --noconfirm mythtv-base-$pkgver-$pkgrel-*.pkg.tar.xz

  conflicts=('mythplugins')

  cd $srcdir/$_gitname-build/mythplugins

  ARCH="${CARCH/_/-}"

  ./configure \
    --cpu="${ARCH}" \
    --arch=${ARCH} \
    --prefix=/usr \
    --compile-type=release \
    --enable-mythgallery

  qmake mythplugins.pro

  make || return 1

  make INSTALL_ROOT="${pkgdir}" install || return 1

}
