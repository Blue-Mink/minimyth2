From d0b4a314008a51b4348913cd07c90006507838ba Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Wed, 19 Nov 2014 21:29:57 +0000
Subject: [PATCH 2/2] RingBuffer: Only decrypt vob files when located on a
 mounted DVD

Signed-off-by: Paul Harrison <pharrison@mythtv.org>
---
 mythtv/libs/libmythtv/ringbuffer.cpp |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/mythtv/libs/libmythtv/ringbuffer.cpp b/mythtv/libs/libmythtv/ringbuffer.cpp
index 98682a5..d830e0f 100644
--- a/mythtv/libs/libmythtv/ringbuffer.cpp
+++ b/mythtv/libs/libmythtv/ringbuffer.cpp
@@ -186,7 +186,11 @@ RingBuffer *RingBuffer::Create(
     if (!mythurl && lower.endsWith(".vob") && lfilename.contains("/VIDEO_TS/"))
     {
         LOG(VB_PLAYBACK, LOG_INFO, "DVD VOB at " + lfilename);
-        return new DVDStream(lfilename);
+        DVDStream *s = new DVDStream(lfilename);
+        if (s && s->IsOpen())
+            return s;
+
+        delete s;
     }
 
     return new FileRingBuffer(
-- 
1.7.10.2

