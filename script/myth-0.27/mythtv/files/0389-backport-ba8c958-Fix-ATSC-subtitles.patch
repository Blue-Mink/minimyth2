From ba8c9584a14263edaf36f55d39dc62a9954ea10f Mon Sep 17 00:00:00 2001
From: Jean-Yves Avenard <jyavenard@mythtv.org>
Date: Fri, 6 Jun 2014 17:18:29 +1000
Subject: [PATCH 07/34] Fix ATSC subtitles.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Was broken following FFmpeg 2.2 resync.

It seems fairly inefficient having the storage storage definition located in the AVFrame structure, as this data will be copied over and over, for all types of AVFrameâ€¦
---
 mythtv/external/FFmpeg/libavutil/frame.c |    7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/mythtv/external/FFmpeg/libavutil/frame.c b/mythtv/external/FFmpeg/libavutil/frame.c
index 747aa79..ead56fa 100644
--- a/mythtv/external/FFmpeg/libavutil/frame.c
+++ b/mythtv/external/FFmpeg/libavutil/frame.c
@@ -505,6 +505,13 @@ int av_frame_copy_props(AVFrame *dst, const AVFrame *src)
         }
     }
 
+    /* MythTV ATSC Subtitle Support -- Begin */
+    dst->atsc_cc_len   = src->atsc_cc_len;
+    dst->scte_cc_len   = src->scte_cc_len;
+    memcpy(dst->atsc_cc_buf, src->atsc_cc_buf, src->atsc_cc_len);
+    memcpy(dst->scte_cc_buf, src->scte_cc_buf, src->scte_cc_len);
+    /* MythTV ATSC Subtitle Support -- End */
+
     return 0;
 }
 
-- 
1.7.10.2

