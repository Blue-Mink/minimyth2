diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/configure.ac mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/configure.ac
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/configure.ac	2019-03-23 15:44:39.356666668 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/configure.ac	2019-03-24 10:04:27.286666656 +0100
@@ -1409,7 +1409,7 @@
 AC_ARG_WITH([gallium-drivers],
     [AS_HELP_STRING([--with-gallium-drivers@<:@=DIRS...@:>@],
         [comma delimited Gallium drivers list, e.g.
-        "i915,nouveau,r300,r600,radeonsi,freedreno,kmsro,svga,swrast,swr,tegra,v3d,vc4,virgl,etnaviv"
+        "i915,nouveau,r300,r600,radeonsi,freedreno,pl111,svga,swrast,swr,tegra,v3d,vc4,virgl,etnaviv,lima"
         @<:@default=r300,r600,svga,swrast@:>@])],
     [with_gallium_drivers="$withval"],
     [with_gallium_drivers="$GALLIUM_DRIVERS_DEFAULT"])
@@ -2880,6 +2880,10 @@
                 require_basic_egl "virgl"
             fi
             ;;
+        xlima)
+            HAVE_GALLIUM_LIMA=yes
+            require_libdrm "lima"
+            ;;
         *)
             AC_MSG_ERROR([Unknown Gallium driver: $driver])
             ;;
@@ -3019,6 +3023,7 @@
 AM_CONDITIONAL(HAVE_GALLIUM_V3D, test "x$HAVE_GALLIUM_V3D" = xyes)
 AM_CONDITIONAL(HAVE_GALLIUM_VC4, test "x$HAVE_GALLIUM_VC4" = xyes)
 AM_CONDITIONAL(HAVE_GALLIUM_VIRGL, test "x$HAVE_GALLIUM_VIRGL" = xyes)
+AM_CONDITIONAL(HAVE_GALLIUM_LIMA, test "x$HAVE_GALLIUM_LIMA" = xyes)
 
 AM_CONDITIONAL(HAVE_GALLIUM_STATIC_TARGETS, test "x$enable_shared_pipe_drivers" = xno)
 
@@ -3163,6 +3168,7 @@
                  src/gallium/drivers/v3d/Makefile
                  src/gallium/drivers/vc4/Makefile
                  src/gallium/drivers/virgl/Makefile
+                 src/gallium/drivers/lima/Makefile
                  src/gallium/state_trackers/clover/Makefile
                  src/gallium/state_trackers/dri/Makefile
                  src/gallium/state_trackers/glx/xlib/Makefile
@@ -3211,6 +3217,7 @@
                  src/gallium/winsys/vc4/drm/Makefile
                  src/gallium/winsys/virgl/drm/Makefile
                  src/gallium/winsys/virgl/vtest/Makefile
+                 src/gallium/winsys/lima/drm/Makefile
                  src/gbm/Makefile
                  src/gbm/main/gbm.pc
                  src/glx/Makefile
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/Makefile.am mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/Makefile.am
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/Makefile.am	2019-03-22 13:53:28.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/Makefile.am	2019-03-24 09:59:30.949999997 +0100
@@ -46,7 +46,7 @@
 	--enable-libunwind \
 	--with-platforms=x11,wayland,drm,surfaceless \
 	--with-dri-drivers=i915,i965,nouveau,radeon,r200,swrast \
-	--with-gallium-drivers=i915,nouveau,r300,kmsro,r600,radeonsi,freedreno,svga,swrast,vc4,tegra,virgl,swr,etnaviv \
+	--with-gallium-drivers=i915,nouveau,r300,kmsro,r600,radeonsi,freedreno,svga,swrast,vc4,tegra,virgl,swr,etnaviv,lima \
 	--with-vulkan-drivers=intel,radeon
 
 ACLOCAL_AMFLAGS = -I m4
@@ -80,6 +80,7 @@
 	include/drm-uapi/tegra_drm.h \
 	include/drm-uapi/v3d_drm.h \
 	include/drm-uapi/vc4_drm.h \
+	include/drm-uapi/lima_drm.h \
 	include/D3D9 \
 	include/GL/wglext.h \
 	include/HaikuGL \
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/drivers/lima/Automake.inc mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/drivers/lima/Automake.inc
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/drivers/lima/Automake.inc	1970-01-01 01:00:00.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/drivers/lima/Automake.inc	2019-03-04 08:39:52.000000000 +0100
@@ -0,0 +1,9 @@
+if HAVE_GALLIUM_LIMA
+
+TARGET_DRIVERS += lima
+TARGET_CPPFLAGS += -DGALLIUM_LIMA
+TARGET_LIB_DEPS += \
+	$(top_builddir)/src/gallium/winsys/lima/drm/liblimadrm.la \
+	$(top_builddir)/src/gallium/drivers/lima/liblima.la
+
+endif
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/drivers/lima/Makefile.am mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/drivers/lima/Makefile.am
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/drivers/lima/Makefile.am	1970-01-01 01:00:00.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/drivers/lima/Makefile.am	2019-03-04 08:39:52.000000000 +0100
@@ -0,0 +1,34 @@
+# Copyright © 2017 Lima Project
+#
+# Permission is hereby granted, free of charge, to any person obtaining a
+# copy of this software and associated documentation files (the "Software"),
+# to deal in the Software without restriction, including without limitation
+# the rights to use, copy, modify, merge, publish, distribute, sublicense,
+# and/or sell copies of the Software, and to permit persons to whom the
+# Software is furnished to do so, subject to the following conditions:
+#
+# The above copyright notice and this permission notice (including the next
+# paragraph) shall be included in all copies or substantial portions of the
+# Software.
+#
+# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
+# THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
+# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
+# IN THE SOFTWARE.
+
+include Makefile.sources
+include $(top_srcdir)/src/gallium/Automake.inc
+
+AM_CFLAGS = \
+	-I$(top_srcdir)/include/drm-uapi \
+	-I$(top_builddir)/src/compiler/nir \
+	-I$(top_srcdir)/src/compiler/nir \
+	$(GALLIUM_DRIVER_CFLAGS) \
+	$(LIBDRM_CFLAGS)
+
+noinst_LTLIBRARIES = liblima.la
+
+liblima_la_SOURCES = $(C_SOURCES)
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/drivers/lima/Makefile.sources mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/drivers/lima/Makefile.sources
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/drivers/lima/Makefile.sources	1970-01-01 01:00:00.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/drivers/lima/Makefile.sources	2019-03-04 08:39:52.000000000 +0100
@@ -0,0 +1,56 @@
+gpir_SOURCES := \
+	  ir/gp/gpir.h \
+	  ir/gp/nir.c \
+	  ir/gp/node.c \
+	  ir/gp/lower.c \
+	  ir/gp/scheduler.c \
+	  ir/gp/instr.c \
+	  ir/gp/codegen.h \
+	  ir/gp/codegen.c \
+	  ir/gp/reduce_scheduler.c \
+	  ir/gp/value_regalloc.c \
+	  ir/gp/physical_regalloc.c \
+	  ir/gp/disasm.c
+
+ppir_SOURCES := \
+	  ir/pp/ppir.h \
+	  ir/pp/nir.c \
+	  ir/pp/node.c \
+	  ir/pp/lower.c \
+	  ir/pp/scheduler.c \
+	  ir/pp/instr.c \
+	  ir/pp/regalloc.c \
+	  ir/pp/codegen.h \
+	  ir/pp/codegen.c \
+	  ir/pp/node_to_instr.c \
+	  ir/pp/disasm.c
+
+ir_SOURCES := \
+	  ir/lima_ir.h \
+	  $(gpir_SOURCES) \
+	  $(ppir_SOURCES)
+
+C_SOURCES := \
+	  lima_screen.c \
+	  lima_screen.h \
+	  lima_context.c \
+	  lima_context.h \
+	  lima_resource.c \
+	  lima_resource.h \
+	  lima_state.c \
+	  lima_draw.c \
+	  lima_program.c \
+	  lima_query.c \
+	  lima_bo.c \
+	  lima_bo.h \
+	  lima_submit.c \
+	  lima_submit.h \
+	  lima_util.c \
+	  lima_util.h \
+	  lima_texture.c \
+	  lima_texture.h \
+	  lima_fence.c \
+	  lima_fence.h \
+	  lima_tiling.c \
+	  lima_tiling.h \
+	  $(ir_SOURCES)
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/Makefile.am mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/Makefile.am
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/Makefile.am	2019-03-22 13:53:28.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/Makefile.am	2019-03-23 16:12:18.209999968 +0100
@@ -56,10 +56,6 @@
 SUBDIRS += drivers/etnaviv winsys/etnaviv/drm
 endif
 
-if HAVE_GALLIUM_KMSRO
-SUBDIRS += drivers/kmsro winsys/kmsro/drm
-endif
-
 ## swrast/softpipe
 if HAVE_GALLIUM_SOFTPIPE
 SUBDIRS += drivers/softpipe
@@ -94,6 +90,11 @@
 SUBDIRS += drivers/virgl winsys/virgl/drm winsys/virgl/vtest
 endif
 
+## lima
+if HAVE_GALLIUM_LIMA
+SUBDIRS += drivers/lima winsys/lima/drm
+endif
+
 ## the sw winsys'
 SUBDIRS += winsys/sw/null
 
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/targets/dri/Makefile.am mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/targets/dri/Makefile.am
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/targets/dri/Makefile.am	2019-03-22 13:53:28.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/targets/dri/Makefile.am	2019-03-24 11:44:43.619999998 +0100
@@ -84,6 +84,8 @@
 
 include $(top_srcdir)/src/gallium/drivers/etnaviv/Automake.inc
 
+include $(top_srcdir)/src/gallium/drivers/lima/Automake.inc
+
 include $(top_srcdir)/src/gallium/drivers/softpipe/Automake.inc
 include $(top_srcdir)/src/gallium/drivers/llvmpipe/Automake.inc
 include $(top_srcdir)/src/gallium/drivers/swr/Automake.inc
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/winsys/lima/drm/Makefile.am mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/winsys/lima/drm/Makefile.am
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/winsys/lima/drm/Makefile.am	1970-01-01 01:00:00.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/winsys/lima/drm/Makefile.am	2019-03-04 08:39:52.000000000 +0100
@@ -0,0 +1,31 @@
+# Copyright © 2017 Lima Project
+#
+# Permission is hereby granted, free of charge, to any person obtaining a
+# copy of this software and associated documentation files (the "Software"),
+# to deal in the Software without restriction, including without limitation
+# the rights to use, copy, modify, merge, publish, distribute, sublicense,
+# and/or sell copies of the Software, and to permit persons to whom the
+# Software is furnished to do so, subject to the following conditions:
+#
+# The above copyright notice and this permission notice (including the next
+# paragraph) shall be included in all copies or substantial portions of the
+# Software.
+#
+# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
+# THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
+# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
+# IN THE SOFTWARE.
+
+include Makefile.sources
+include $(top_srcdir)/src/gallium/Automake.inc
+
+AM_CFLAGS = \
+	-I$(top_srcdir)/src/gallium/drivers \
+	$(GALLIUM_WINSYS_CFLAGS)
+
+noinst_LTLIBRARIES = liblimadrm.la
+
+liblimadrm_la_SOURCES = $(C_SOURCES)
diff -Naur mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/winsys/lima/drm/Makefile.sources mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/winsys/lima/drm/Makefile.sources
--- mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-old/src/gallium/winsys/lima/drm/Makefile.sources	1970-01-01 01:00:00.000000000 +0100
+++ mesa-bf5a92811d5564f0d4f7a83814e3965170b823f0-new/src/gallium/winsys/lima/drm/Makefile.sources	2019-03-04 08:39:52.000000000 +0100
@@ -0,0 +1,3 @@
+C_SOURCES := \
+	lima_drm_public.h \
+	lima_drm_winsys.c
