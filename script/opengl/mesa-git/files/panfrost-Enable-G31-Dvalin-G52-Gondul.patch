From 4ad84051e6f24003839df84d5a375bde0b5e18ee Mon Sep 17 00:00:00 2001
From: Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>
Date: Thu, 30 Apr 2020 09:32:57 +0200
Subject: [PATCH] panfrost: Enable G31 (Dvalin) and G52 (Gondul)

Signed-off-by: Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>
Signed-off-by: Tomeu Vizoso <tomeu.vizoso@collabora.com>
---
 src/gallium/drivers/panfrost/pan_screen.c | 2 ++
 src/panfrost/encoder/pan_props.c          | 6 +++++-
 2 files changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/gallium/drivers/panfrost/pan_screen.c b/src/gallium/drivers/panfrost/pan_screen.c
index 866c23adc93..24eb8b4924c 100644
--- a/src/gallium/drivers/panfrost/pan_screen.c
+++ b/src/gallium/drivers/panfrost/pan_screen.c
@@ -750,6 +750,8 @@ panfrost_create_screen(int fd, struct renderonly *ro)
         case 0x750: /* T760 */
         case 0x820: /* T820 */
         case 0x860: /* T860 */
+        case 0x7093: /* G31 */
+        case 0x7212: /* G52 */
                 break;
         default:
                 /* Fail to load against untested models */
diff --git a/src/panfrost/encoder/pan_props.c b/src/panfrost/encoder/pan_props.c
index 3f751be949f..c8220bbeb93 100644
--- a/src/panfrost/encoder/pan_props.c
+++ b/src/panfrost/encoder/pan_props.c
@@ -24,6 +24,7 @@
  *   Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>
  */
 
+#include <stdio.h>
 #include <xf86drm.h>
 
 #include "util/u_math.h"
@@ -107,8 +108,11 @@ panfrost_model_name(unsigned gpu_id)
         case 0x750: return "Mali T760 (Panfrost)";
         case 0x860: return "Mali T860 (Panfrost)";
         case 0x880: return "Mali T880 (Panfrost)";
+        case 0x7093: return "Mali G31 (Panfrost)";
+        case 0x7212: return "Mali G52 (Panfrost)";
         default:
-                    unreachable("Invalid GPU ID");
+                    fprintf(stderr, "Unsupported GPU ID %x\n", gpu_id);
+                    assert(0);
         }
 }
 
-- 
2.26.2

