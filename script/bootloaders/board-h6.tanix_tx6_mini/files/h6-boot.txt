#
# To prepare u-boot script, run:
# mkimage -A arm64 -T script -O linux -d h6-boot.txt h6-boot.scr
#

part uuid ${devtype} ${devnum}:2 uuid

setenv bootargs root=PARTUUID=${uuid} rw rootwait earlycon console=ttyS0,115200n8 logo.nologo vt.cur_default=1

setenv fdtfile dtbs/allwinner/sun50i-h6-tanix-tx6-mini.dtb
setenv userfdtfile h6_dtb

if load ${devtype} ${devnum}:${bootpart} ${kernel_addr_r} /Image; then
  if load ${devtype} ${devnum}:${bootpart} ${fdt_addr_r} /${userfdtfile}; then
    fdt addr ${fdt_addr_r}
    fdt resize
    booti ${kernel_addr_r} - ${fdt_addr_r};
  else
    if load ${devtype} ${devnum}:${bootpart} ${fdt_addr_r} /${fdtfile}; then
      fdt addr ${fdt_addr_r}
      fdt resize
      booti ${kernel_addr_r} - ${fdt_addr_r};
    else
      booti ${kernel_addr_r} - ${fdtcontroladdr};
    fi;
  fi;
fi
